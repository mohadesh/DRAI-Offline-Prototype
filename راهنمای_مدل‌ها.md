# محل قرارگیری مدل‌های پیش‌بینی MD و C

برنامه برای **پیش‌بینی MD** و **پیش‌بینی C** به دو فایل مدل (`.pkl`) نیاز دارد. مسیرها به **بازهٔ مدل (فرکانس)** که در صفحهٔ آپلود انتخاب می‌کنید بستگی دارد: **۱ ساعت (1h)**، **۱۵ دقیقه (15T)**، یا **۳۰ دقیقه (30T)**.

---

## گزینهٔ ۱: پوشهٔ pipeline در `analysis` (پیشنهادی)

اگر داخل پروژهٔ اپ یک پوشهٔ `analysis` بسازید، برنامه اول آنجا را نگاه می‌کند.

**مسیر پایه (نسبت به پوشهٔ `my_inference_app`):**
```
my_inference_app/
  analysis/
    darts_pipeline_freq_15T_* /    ← یک پوشه با اسمی شبیه این (برای 15T)
    darts_pipeline_freq_1h_*  /    ← برای 1h
    darts_pipeline_freq_30T_* /    ← برای 30T
```

**داخل هر پوشهٔ pipeline باید این ساختار باشد:**
```
darts_pipeline_freq_15T_horizon_8_lr_0.03_depth_18/   (مثال برای 15T)
  MDNC_M_D/
    model_MDNC_M_D.pkl
  MDNC_C/
    model_MDNC_C.pkl
```

یعنی برای **15T** باید مدل‌ها اینجا باشند:
- `my_inference_app/analysis/darts_pipeline_freq_15T_XXXX/MDNC_M_D/model_MDNC_M_D.pkl`
- `my_inference_app/analysis/darts_pipeline_freq_15T_XXXX/MDNC_C/model_MDNC_C.pkl`

(به‌جای `XXXX` می‌تواند هر پسوندی باشد، مثلاً `horizon_8_lr_0.03_depth_18`.)

---

## گزینهٔ ۲: پروژهٔ DRAI-Modeling (همان پروژهٔ کناری)

اگر پوشهٔ `my_inference_app/analysis` وجود نداشته باشد، برنامه به پروژهٔ هم‌سطح نگاه می‌کند:

**مسیر (نسبت به ریشهٔ پروژهٔ DRAI-OFFLINE):**
```
DRAI-OFFLINE/
  DRAI-Modeling/
    data/
      analysis/
        darts_pipeline_freq_15T_horizon_8_lr_0.03_depth_18/   ← برای 15T
          MDNC_M_D/
            model_MDNC_M_D.pkl
          MDNC_C/
            model_MDNC_C.pkl
```

یعنی برای **15T** مسیر کامل مدل‌ها:
- `DRAI-OFFLINE/DRAI-Modeling/data/analysis/darts_pipeline_freq_15T_.../MDNC_M_D/model_MDNC_M_D.pkl`
- `DRAI-OFFLINE/DRAI-Modeling/data/analysis/darts_pipeline_freq_15T_.../MDNC_C/model_MDNC_C.pkl`

در پروژهٔ شما این پوشه‌ها و فایل‌ها **از قبل وجود دارند**. اگر باز هم «مدل در دسترس نیست» می‌بینید، احتمالاً سرور از مسیر دیگری اجرا شده یا دسترسی به فایل نیست.

---

## گزینهٔ ۳: فقط برای فرکانس ۳۰ دقیقه (30T) — پوشهٔ `models`

فقط وقتی فرکانس **۳۰ دقیقه (30T)** را انتخاب کرده‌اید، در صورت نبودن پوشهٔ pipeline، برنامه به پوشهٔ `models` داخل اپ نگاه می‌کند:

**مسیر (داخل my_inference_app):**
```
my_inference_app/
  models/
    model_MDNC_M_D.pkl
    model_MDNC_C.pkl
```

برای **1h** و **15T** این fallback وجود ندارد؛ حتماً باید از گزینهٔ ۱ یا ۲ استفاده شود.

---

## چک کردن از داخل برنامه

وقتی سرور را با `python app.py` اجرا می‌کنید، در ترمینال بلافاصله لیست مسیرهای جستجو و وضعیت هر فرکانس (OK یا MISSING) چاپ می‌شود. بعد از هر آپلود هم خطی شبیه این می‌آید:
```
[Models] frequency=15T → MD: /path/to/model_MDNC_M_D.pkl, C: /path/to/model_MDNC_C.pkl
```
اگر به‌جای مسیر `NOT FOUND` دیدید، یعنی همان فرکانس مدل پیدا نشده و باید فایل‌ها را در یکی از مسیرهای بالا قرار دهید.

---

## خلاصه برای فرکانس ۱۵ دقیقه (15T)

- یا در **`my_inference_app/analysis/darts_pipeline_freq_15T_*/`** پوشه‌های `MDNC_M_D` و `MDNC_C` با فایل‌های `.pkl` بگذارید،  
- یا مطمئن شوید در **`DRAI-Modeling/data/analysis/`** یک پوشه به شکل `darts_pipeline_freq_15T_*` وجود دارد و داخلش `MDNC_M_D/model_MDNC_M_D.pkl` و `MDNC_C/model_MDNC_C.pkl` هست.

سرور را حتماً از داخل پوشهٔ `my_inference_app` (یا از ریشهٔ پروژه با مسیر کامل به `app.py`) اجرا کنید تا مسیر نسبی `../DRAI-Modeling` درست resolve شود.
